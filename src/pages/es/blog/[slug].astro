---
import { getCollection } from 'astro:content';
import PostLayout from '../../../layouts/PostLayout.astro';
import { getPostTranslations } from '../../../i18n/utils';

export async function getStaticPaths() {
  const blogEntries = await getCollection('blog', ({ id }) => {
    return id.startsWith('es/');
  });
  
  return blogEntries.map(entry => {
    // Extraer el slug del id (formato: "es/nombre-archivo")
    const slug = entry.id.replace('es/', '').replace('.md', '');
    return {
      params: { slug },
      props: { entry },
    };
  });
}

const { entry } = Astro.props;
const { Content } = await entry.render();

// Obtener las traducciones del post usando el idx
const translations = await getPostTranslations(entry.data.idx, 'es');
---

<PostLayout frontmatter={entry.data} translations={translations}>
  <Content />
</PostLayout>
